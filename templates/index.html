<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Prompt Polisher</title>
<link rel="icon" href="/static/favicon.ico">
<style>
  :root{ --red:#c62828; --red-dark:#8e0000; --ink:#111; --muted:#6b7280;
         --bg:#fafafa; --card:#fff; --ring:rgba(0,0,0,.08);
         --shadow:0 10px 25px rgba(0,0,0,.08), 0 2px 8px rgba(0,0,0,.06);
         --radius:18px; }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,Segoe UI,Roboto,Arial}
  .banner{background:var(--red);color:#fff;box-shadow:var(--shadow)}
  .band{max-width:1100px;margin:0 auto;display:flex;gap:18px;align-items:center;padding:18px 22px}
  .band img{width:64px;height:64px;border-radius:50%;object-fit:cover;box-shadow:0 6px 14px rgba(0,0,0,.25);border:3px solid rgba(255,255,255,.9)}
  .title{font-weight:800;letter-spacing:.3px;font-size:28px}
  .sub{opacity:.92;font-size:14px;margin-top:2px}
  .wrap{max-width:1100px;margin:28px auto;padding:0 22px}
  .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:22px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
  .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:22px;border:1px solid var(--ring)}
  h2{margin:0 0 12px 0;font-size:18px}
  textarea{width:100%;min-height:220px;resize:vertical;padding:14px 16px;border-radius:14px;border:1px solid var(--ring);outline:none}
  textarea:focus{border-color:#bbb;box-shadow:0 0 0 4px rgba(198,40,40,.12)}
  .row{display:flex;gap:12px;align-items:center;margin-top:14px}
  button{background:var(--red);color:#fff;border:0;padding:12px 18px;border-radius:12px;font-weight:700;letter-spacing:.3px;cursor:pointer;box-shadow:var(--shadow)}
  button:hover{background:var(--red-dark)}
  .muted{color:var(--muted)}
  pre{margin:0;white-space:pre-wrap;background:#f7f7f7;padding:16px;border-radius:14px;border:1px solid var(--ring)}
  .err{background:#fff0f0;border-color:#ffd2d2}
  .badge{display:inline-block;background:#ffe4e4;color:#7a0000;border:1px solid #ffbdbd;padding:2px 8px;border-radius:999px;font-size:12px}
</style>
</head>
<body>
  <header class="banner">
    <div class="band">
      <img src="/static/framed-charles.png" alt="Charles" onerror="this.style.display='none'">
      <div>
        <div class="title">Prompt Polisher</div>
        <div class="sub">Make any draft sharper, shorter and more persuasive — instantly.</div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <section class="card">
        <h2>Paste your draft</h2>
        <form id="form">
          <textarea name="prompt" placeholder="Drop your email, LinkedIn post or paragraph here..."></textarea>
          <div class="row">
            <button type="submit">Polish</button>
            <span id="status" class="muted">Ready</span>
          </div>
        </form>
      </section>

      <aside class="card">
        <h2>Result <span id="badge" class="badge" style="display:none">Error</span></h2>
        <pre id="out">—</pre>
      </aside>
    </div>
  </main>

<script>
const form = document.getElementById('form');
const out  = document.getElementById('out');
const statusEl = document.getElementById('status');
const badge = document.getElementById('badge');

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  badge.style.display = 'none';
  out.classList.remove('err');
  statusEl.textContent = 'Thinking…';
  const data = new FormData(form);
  try {
    const res = await fetch('/api/polish', { method: 'POST', body: data });
    const json = await res.json();
    if (json.ok) {
      out.textContent = json.response || 'No content';
      statusEl.textContent = 'Done';
    } else {
      out.textContent = json.error || 'Unknown error';
      out.classList.add('err');
      badge.style.display = 'inline-block';
      statusEl.textContent = 'Error';
    }
  } catch (err) {
    out.textContent = String(err);
    out.classList.add('err');
    badge.style.display = 'inline-block';
    statusEl.textContent = 'Network error';
  }
});
</script>
</body>
</html>
